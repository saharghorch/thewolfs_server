<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:head>
<ui:include src="/template/header.xhtml"/>
<title><ui:insert name="title"></ui:insert></title>
</h:head> 

		<body>
			<h:form id="form1">
				<p:dataTable id="userlist" value="#{userBean.users}" var="user"
					rowKey="#{user.id}" resizableColumns="true" selectionMode="single"
					selection="#{userBean.selectedUser}">
					<f:facet name="header">
						Users list
					</f:facet>
					
					<p:column headerText="Name">
						<h:outputText value="#{user.first_name} #{user.last_name}" />
					</p:column>

					<p:column headerText="Birth date ">
						<h:outputText
							value="#{(user.birth_date == null) ? '-' : user.birth_date }" />
					</p:column>

					<p:column headerText="Email">
						<h:outputText value="#{user.email}" />
					</p:column>

					<p:column headerText="Phone">
						<h:outputText value="#{user.phone}" />
					</p:column>

					<p:column headerText="Etat">
						<h:outputText value="#{user.state}" />
					</p:column>

					<p:column headerText="Etat du compte">
						<h:outputText value="#{user.accountstate}" />
					</p:column>

					<p:column headerText="Role">
						<h:outputText value="#{user.role}" />
					</p:column>

				</p:dataTable>


				<p:contextMenu for="userlist">
					<p:menuitem value="Update" icon="ui-icon-edit"
						onclick="PF('dlg1').show();"
						actionListener="#{userBean.uploadUpdateData()}">

					</p:menuitem>
					<p:menuitem value="Delete" icon="ui-icon-delete"
						actionListener="#{userBean.removeUser()}">
						<p:confirm header="Confirmation" message="Are you sure ? "
							icon="ui-icon-alert" />
					</p:menuitem>
					<p:menuitem value="Bann" actionListener="#{userBean.bannUser()}" icon="ui-icon-block">
					<p:confirm header="Confirmation" message="Are you sure you want to bann this user ? "
							icon="ui-icon-alert" />
					</p:menuitem>
					<p:menuitem value="UnBann" actionListener="#{userBean.unBannUser()}" icon="ui-icon-offline-pin" />
				</p:contextMenu>

				<p:confirmDialog global="true">
					<p:commandButton value="Yes" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="No" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>


				<p:dialog header="Update User" modal="true" widgetVar="dlg1">
					<p:outputLabel value="First name"></p:outputLabel>
					<p:inputText value="#{userBean.first_name}"></p:inputText>
					<p:commandButton value="Update" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
						onclick="#{userBean.updateUser()}" />
				</p:dialog>
			</h:form>

			<p:separator />
			
			<h:form id="addForm">
				<table align="center">

					<tr>

						<td><p:outputLabel value="First name"></p:outputLabel></td>
						<td><p:inputText id="firstN" value="#{userBean.first_name}"
								required="true">
							</p:inputText></td>
					</tr>
					<tr>
						<td><p:outputLabel value="Last name"></p:outputLabel></td>
						<td><p:inputText value="#{userBean.last_name}"
								required="true" /></td>
					</tr>
					<tr>
						<td><p:outputLabel value="Gender"></p:outputLabel></td>
						<td><h:selectOneMenu value="#{userBean.gender}"
								required="true">
								<f:selectItem itemLabel="Select gender .." itemValue="" />
								<f:selectItems value="#{genderData.gender}" />
							</h:selectOneMenu></td>
					</tr>
					<tr>
						<td><p:outputLabel value="Birth date"></p:outputLabel></td>
						<td><p:calendar required="true" id="button"
								value="#{userBean.birth_date}" showOn="button" /></td>
					</tr>
					<tr>
						<td><p:outputLabel value="Email"></p:outputLabel></td>
						<td><p:inputText value="#{userBean.email}" required="true" /></td>
					</tr>
					<tr>
						<td><p:outputLabel value="Phone number"></p:outputLabel></td>
						<td><p:inputText value="#{userBean.phone}" required="true" /></td>
					</tr>

					<tr>
						<td><p:outputLabel value="Role"></p:outputLabel></td>
						<td><h:selectOneMenu value="#{userBean.role}" required="true">
								<f:selectItem itemLabel="Select a role .." itemValue="" />
								<f:selectItems value="#{roleData.roles}" />
							</h:selectOneMenu></td>
					</tr>
					<tr>
						<td colspan="2" align="center"><p:commandButton
								action="#{userBean.addUser()}" value="Add New user" /></td>
					</tr>
				</table>

			</h:form>

			
<ui:include src="/template/footer.xhtml"/>
</body> 
</html>
